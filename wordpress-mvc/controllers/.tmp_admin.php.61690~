<?php
class Admin extends Sistema{
	var $data;
	var $topPage = 'catmvc';
	var $access_level= 6;
	
	public function __construct(){
		parent::__construct();
		$this->data['title'] = 'Catalogo de Pantallas';
		$this->data['menu_title'] = 'Catalogo';
		
	}   
	function add_menu(){
		add_menu_page($this->data['title'],$this->data['menu_title'],$this->access_level,$this->topPage,array ( $this , 'principal'),$this->urlBase.'/theme/img/pantalla.png');
		add_submenu_page($this->topPage,'Categorias','Categorias',$this->access_level,'categorias',array ( $this , 'categorias'));
		add_submenu_page($this->topPage,'Productos','Productos',$this->access_level,'productos',array ( $this , 'productos'));
		add_submenu_page($this->topPage,'','',$this->access_level,'cat-add',array ( $this , 'catadd'));
		add_submenu_page($this->topPage,'','',$this->access_level,'cat-mod',array ( $this , 'catmod'));		
		add_submenu_page($this->topPage,'','',$this->access_level,'images',array ( $this , 'imagenes'));
	 	add_management_page('', '', 0, 'jsu-opt', array ( $this , 'jsSwfUpload'));	
	 	add_management_page('', '', 0, 'jsu-head', array ( $this , 'jsuHead'));
	}
	function principal(){
		$basename= split('/', plugin_basename(__FILE__));
		echo WP_PLUGIN_URL.'/'.$basename[0]. ' WP_PLUGIN_URL<br/>';
		echo plugin_basename(__FILE__). ' plugin_basename(__FILE__)<br/>';
	}
	function categorias(){
		$mod = parent::loadModel('Mod_categorias');
		$this->view('cat/cat-add');
		$this->verCategorias($mod);
	}
	function productos(){
		add_action('wp_head',$this->jsuHead());	
		$this->view('prod/prod-add');
	}
	function catadd(){
		$mod = parent::loadModel('Mod_categorias');
		$mod->crear();
		$this->verCategorias($mod);
	}
	function catmod(){
		$mod = parent::loadModel('Mod_categorias');
		$mod->modifica();
		$this->verCategorias($mod);
	}
	function verCategorias($mod){
		$this->data['categorias']= $mod->listaCat();
		parent::view('cat/cat-add',$this->data);
		parent::view('cat/cat-view',$this->data);
		
	}
}
?>